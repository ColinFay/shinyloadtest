<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tools for laod testing Shiny applications • shinyloadtest</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">shinyloadtest</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">
    <div id="shinyloadtest" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#shinyloadtest" class="anchor"> </a>shinyloadtest</h1></div>

<p>This package extends the <a href="https://github.com/rstudio/shinytest">shinytest package</a> to enable users to load test deployed Shiny applications. Load testing is executed using parallel phantomJS sessions.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"> </a>Installation</h2>
<p>Currently, <code>shinyloadtest</code> is available on Github:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">"rstudio/shinyloadtest"</span>)</code></pre></div>
<p>You will also need to install <code>shinytest</code> and <code>phantomJS</code>. <code>shinytest</code> includes a helper function to install the latest version of <code>phantomJS</code>.</p>
</div>
<div id="record-test" class="section level2">
<h2 class="hasAnchor">
<a href="#record-test" class="anchor"> </a>Record Test</h2>
<p>To get started, record a test using the <code>shinytest</code> package’s recorder with <code>load_mode</code> enabled. The test should be reflective of expected application use. For more details, see the <a href="https://rstudio.github.io/shinytest/"><code>shinytest</code> documentation</a>. Tests must be recorded against a local copy of the deployed application.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(shinytest)
<span class="kw">recordTest</span>(<span class="st">"path/to/app"</span>, <span class="dt">load_mode =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="../examples/img/recorder_screenshot_superzip.png"></p>
<p>The recorder will save interactions with the application and timing information into a R file. For example, the following script is a test script for the <a href="http://shiny.rstudio.com/gallery/superzip-example.html">superzip application</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">app &lt;-<span class="st"> </span>ShinyLoadDriver$<span class="kw">new</span>()
app$<span class="kw">snapshotInit</span>(<span class="st">"myloadtest"</span>)

app$<span class="kw">setInputs</span>(<span class="dt">size =</span> <span class="st">"college"</span>)
<span class="kw">Sys.sleep</span>(<span class="fl">3.1</span>)
app$<span class="kw">setInputs</span>(<span class="dt">threshold =</span> <span class="dv">6</span>)
<span class="kw">Sys.sleep</span>(<span class="fl">0.5</span>)
app$<span class="kw">setInputs</span>(<span class="dt">threshold =</span> <span class="dv">7</span>)
<span class="kw">Sys.sleep</span>(<span class="fl">1.4</span>)
app$<span class="kw">setInputs</span>(<span class="dt">threshold =</span> <span class="dv">8</span>)
<span class="kw">Sys.sleep</span>(<span class="fl">0.0</span>)
app$<span class="kw">setInputs</span>(<span class="dt">threshold =</span> <span class="dv">7</span>)
<span class="kw">Sys.sleep</span>(<span class="fl">8.4</span>)
app$<span class="kw">setInputs</span>(<span class="dt">nav =</span> <span class="st">"Data explorer"</span>)
<span class="kw">Sys.sleep</span>(<span class="fl">0.4</span>)
app$<span class="kw">setInputs</span>(<span class="dt">states =</span> <span class="st">"CO"</span>)
<span class="kw">Sys.sleep</span>(<span class="fl">1.5</span>)


app$<span class="kw">snapshot</span>()
app$<span class="kw">stop</span>()
app$<span class="kw">getEventLog</span>()</code></pre></div>
<p>The key components of the test script that are unique to <code>load_mode</code> are the lines:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">app &lt;-<span class="st"> </span>ShinyLoadDriver$<span class="kw">new</span>() <span class="co"># instructs the load test to use a LoadDriver</span>

<span class="kw">Sys.sleep</span>()                  <span class="co"># records user pauses between inputs</span>

app$<span class="kw">snapshot</span>()               <span class="co"># takes a screenshot of the application</span>
app$<span class="kw">stop</span>()                   <span class="co"># disconnects from the application</span>
app$<span class="kw">getEventLog</span>()            <span class="co"># returns the event log with timing information</span></code></pre></div>
</div>
<div id="running-load-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#running-load-tests" class="anchor"> </a>Running Load Tests</h2>
<p>One way to run a load test against the deployed application is to use the <code>loadTest</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(shinyloadtest)  
<span class="kw"><a href="reference/loadTest.html">loadTest</a></span>(<span class="dt">testFile =</span> <span class="st">'myloadTest.R'</span>,
         <span class="dt">url =</span> <span class="st">'https://beta.rstudioconnect.com/content/2551'</span>,
         <span class="dt">numConcurrent =</span> <span class="dv">8</span>,
         <span class="dt">numTotal =</span> <span class="dv">16</span>,
         <span class="dt">loadTimeout =</span> <span class="dv">5</span>,
         <span class="dt">stagger =</span> <span class="dv">4</span>, 
         <span class="dt">phantomTimeout =</span> <span class="dv">20</span>)</code></pre></div>
<p>This function uses the <code>parallel</code> and <code>foreach</code> packages to open concurrent R processes. Each R process uses phantomJS to run the recorded test against the deployed application.</p>
<p><code>numConcurrent</code> is the number of concurrent connections to the application.</p>
<p><code>numTotal</code> is the total number of tests run against the application.</p>
<p><code>loadTimeout</code> is the maximum amount of seconds to wait for the Shiny app to load.</p>
<p><code>stagger</code> adds a random delay of up to <code>stagger</code> seconds to the concurrent connections.</p>
<p><code>phantomTimeout</code> is the maximum seconds to wait for the phantomJS process to start.</p>
<p><strong>WARNING</strong> Load testing a large number of concurrent connections will open a large number of processes on the client computer. Use with caution.</p>
<p>The <code>loadTest</code> function returns an event log that contains timing and event information for each visit to the application.</p>
</div>
<div id="running-load-test-reports" class="section level2">
<h2 class="hasAnchor">
<a href="#running-load-test-reports" class="anchor"> </a>Running Load Test Reports</h2>
<p>The package includes a R Markdown report. The report is located at:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">path.expand</span>(<span class="kw">paste0</span>(<span class="kw">path.package</span>(<span class="st">"shinyloadtest"</span>), <span class="st">"/inst/load_test_template.Rmd"</span>))</code></pre></div>
<p>The report is parameterized. To run the report, open the report and then select <code>Knit with Parameters</code> from within RStudio:</p>
<p><img src="../examples/img/knit_with_params.png"></p>
<p>You will be prompted to enter the parameters for your load test:</p>
<p><img src="../examples/img/params.png"></p>
<p><strong>WARNING</strong> This report can take a long time to render and will generate multiple processes on the client machine. Use with caution. In addition to running the load test, this report will sequentially run a baseline test. This baseline test runs the test script in sequence and can take time if each individual test is lengthy.</p>
<p>An alternatvie approach is to update the parameters in the YAML, change the output format to <code>html_notebook</code>, and to interactively run each code chunk. Once done, you can preview the notebook which generates an html report from the interactively run code, wihout compiling the report all at once.</p>
<p>For an example report, run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setwd</span>(<span class="kw">path.expand</span>(<span class="kw">paste0</span>(<span class="kw">path.package</span>(<span class="st">"shinyloadtest"</span>),<span class="st">"/inst/inst/"</span>)))
rmarkdown::<span class="kw">render</span>(<span class="st">"load_test_template.Rmd"</span>)</code></pre></div>
<p>which should generate a <a href="https://beta.rstudioconnect.com/content/2552/load_test_template.html">report like this</a>.</p>
</div>
<div id="use-cases" class="section level2">
<h2 class="hasAnchor">
<a href="#use-cases" class="anchor"> </a>Use Cases</h2>
<p><code>shinyloadtest</code> is best suited for testing applications with 20-60 concurrent connections. Driving more load on the deployed appliction is possible, but may require a server to act as the client.</p>
<p>We recommend using <code>shinyloadtest</code> to experiment with application performance and tuning. For more details see: <a href="https://support.rstudio.com/hc/en-us/articles/220546267-Scaling-and-Performance-Tuning-Applications-in-Shiny-Server-Pro">Performance Tuning for Shiny Server Pro</a>, <a href="https://support.rstudio.com/hc/en-us/articles/231874748">Performance Tuning for RStudio Connect</a>, and <a href="http://shiny.rstudio.com/articles/scaling-and-tuning.html">Performance Tuning for shinyapps.io</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3" id="sidebar">
    <h2>License</h2>
<p><a href="http://www.R-project.org/Licenses/GPL-3">GPL-3</a></p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Sean Lopp <br><small class="roles"> Author, maintainer </small> </li>
<li>Winston Chang <br><small class="roles"> Author </small> </li>
</ul>
<html><body>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/rstudio/shinyloadtest"><img src="https://travis-ci.org/rstudio/shinyloadtest.svg?branch=master" alt="Build Status"></a></li>
</ul>
</body></html>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Sean Lopp, Winston Chang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
